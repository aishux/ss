SELECT DISTINCT
    O.IDENTIFICATION,
    SUBSTRING(O.IDENTIFICATION, 1, INSTR(O.IDENTIFICATION, '*') - 1) AS COST_CENTRE,
    CASE
        WHEN LENGTH(O.IDENTIFICATION) - LENGTH(REPLACE(O.IDENTIFICATION, '-', '')) = 2 THEN
            CONCAT(
                SUBSTRING(
                    O.IDENTIFICATION, 
                    INSTR(O.IDENTIFICATION, '-') + 1, 
                    INSTR(SUBSTRING(O.IDENTIFICATION, INSTR(O.IDENTIFICATION, '-') + 1), '-') - 1
                ),
                '-',
                SUBSTRING(
                    O.IDENTIFICATION,
                    INSTR(O.IDENTIFICATION, '-', INSTR(O.IDENTIFICATION, '-') + 1) + 1
                )
            )
        ELSE
            SUBSTRING(
                O.IDENTIFICATION, 
                INSTR(O.IDENTIFICATION, '-') + 1, 
                INSTR(SUBSTRING(O.IDENTIFICATION, INSTR(O.IDENTIFICATION, '-') + 1), '-') - 1
            )
    END AS CLIENT_ADVISOR,
    O.NAME AS CLIENT_ADVISOR_NAME,
    R.PARTNER_ELEMENT_ID AS PARTNER_ID
FROM governed.gmis_gpc_clientmi_dim_org_governed O
JOIN governed.gmis_gpc_clietmi_dim_par_org_rel_governed R
    ON R.ORGANIZATION_ELEMENT_ID = O.ID
WHERE 
    O.VALID_TO_EXCL IS NULL 
    AND R.VALID_TO_EXCL IS NULL 
    AND R.RELATION_TYPE_ID = '1';
