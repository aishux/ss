I have refactored the code to make it as generic as possible, allowing it to work with any table passed as input. The logic has been modularized, and key components such as summarization and data fetching are now adaptable based on the table structure.

This version is designed to be flexible and scalable, and I’ve kept the summarization logic dynamic based on the aggregation_set and leaf_func_desc fields. As more use cases arise, I’ll continue refining it further to support additional table formats and summarization needs.
