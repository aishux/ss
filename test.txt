SELECT DISTINCT
    O.IDENTIFICATION,
    REGEXP_SUBSTR(O.IDENTIFICATION, '^[^*]+') AS COST_CENTRE, -- Extracts everything before the first '-'
    CASE
        WHEN LENGTH(O.IDENTIFICATION) - LENGTH(REPLACE(O.IDENTIFICATION, '-', '')) = 2 THEN
            CONCAT(
                REGEXP_SUBSTR(O.IDENTIFICATION, '(?<=-)[^-]+'), -- Extracts first segment after '-'
                '-',
                REGEXP_SUBSTR(O.IDENTIFICATION, '(?<=-)[^-]+', 2) -- Extracts second segment after '-'
            )
        ELSE
            REGEXP_SUBSTR(O.IDENTIFICATION, '(?<=-)[^-]+') -- Extracts the first segment after '-'
    END AS CLIENT_ADVISOR,
    O.NAME AS CLIENT_ADVISOR_NAME,
    R.PARTNER_ELEMENT_ID AS PARTNER_ID
FROM governed.gmis_gpc_clientmi_dim_org_governed O
JOIN governed.gmis_gpc_clietmi_dim_par_org_rel_governed R
    ON R.ORGANIZATION_ELEMENT_ID = O.ID
WHERE 
    O.VALID_TO_EXCL IS NULL 
    AND R.VALID_TO_EXCL IS NULL 
    AND R.RELATION_TYPE_ID = '1';
